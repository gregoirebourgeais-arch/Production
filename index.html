<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Atelier PPNC</title>

  <!-- Manifest + PWA -->
  <link rel="manifest" href="manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>

  <!-- Style principal -->
  <link rel="stylesheet" href="style.css">

  <!-- Librairies -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>

<body>
  <header class="header">
    <img src="logo-lactalis.png" alt="Logo Lactalis" class="logo">
    <div class="titre">
      <h1>Atelier PPNC</h1>
      <p id="dateTimeDisplay"></p>
      <p id="weekDisplay"></p>
    </div>
  </header>

  <nav class="menu">
    <button onclick="openPage('atelier')">Atelier</button>
    <button onclick="openPage('production')">Production</button>
    <button onclick="openPage('arrets')">ArrÃªts</button>
    <button onclick="openPage('organisation')">Organisation</button>
    <button onclick="openPage('personnel')">Personnel</button>
  </nav>

  <!-- SECTION ATELIER -->
  <section id="atelier" class="page active">
    <h2>Vue d'ensemble Atelier</h2>
    <canvas id="atelierChart" height="140"></canvas>

    <div id="atelierHistorique">
      <h3>Historique Production</h3>
      <ul id="historiqueProduction"></ul>

      <h3>Historique ArrÃªts</h3>
      <ul id="historiqueArrets"></ul>

      <h3>Historique Organisation</h3>
      <ul id="historiqueOrganisation"></ul>

      <h3>Historique Personnel</h3>
      <ul id="historiquePersonnel"></ul>
    </div>

    <button class="export" onclick="exportAllExcel()">ðŸ“Š Export Excel global</button>
  </section>

  <!-- SECTION PRODUCTION -->
  <section id="production" class="page">
    <h2>Production</h2>
    <div class="ligne-selection">
      <button onclick="selectLine('RÃ¢pÃ©')">RÃ¢pÃ©</button>
      <button onclick="selectLine('T2')">T2</button>
      <button onclick="selectLine('RT')">RT</button>
      <button onclick="selectLine('OMORI')">OMORI</button>
      <button onclick="selectLine('T1')">T1</button>
      <button onclick="selectLine('Sticks')">Sticks</button>
      <button onclick="selectLine('Emballage')">Emballage</button>
      <button onclick="selectLine('DÃ©s')">DÃ©s</button>
      <button onclick="selectLine('Filets')">Filets</button>
      <button onclick="selectLine('PrÃ©dÃ©coupÃ©s')">PrÃ©dÃ©coupÃ©s</button>
    </div>

    <div id="ligneContainer"></div>
  </section>

  <!-- SECTION ARRETS -->
  <section id="arrets" class="page">
    <h2>ArrÃªts</h2>
    <form id="arretForm">
      <label>Ligne :</label>
      <select id="arretLigne">
        <option value="">SÃ©lectionner...</option>
        <option>RÃ¢pÃ©</option>
        <option>T2</option>
        <option>RT</option>
        <option>OMORI</option>
        <option>T1</option>
        <option>Sticks</option>
        <option>Emballage</option>
        <option>DÃ©s</option>
        <option>Filets</option>
        <option>PrÃ©dÃ©coupÃ©s</option>
      </select>

      <label>Type :</label>
      <select id="arretType">
        <option>DÃ©coupe</option>
        <option>Packing</option>
        <option>MEC</option>
      </select>

      <label>Commentaire :</label>
      <textarea id="arretCommentaire"></textarea>

      <button type="button" onclick="saveArret()">Enregistrer</button>
    </form>

    <h3>Historique des arrÃªts</h3>
    <ul id="listeArrets"></ul>
  </section>

  <!-- SECTION ORGANISATION -->
  <section id="organisation" class="page">
    <h2>Organisation / Consignes</h2>
    <form id="consigneForm">
      <label>Nouvelle consigne :</label>
      <textarea id="nouvelleConsigne"></textarea>
      <label><input type="checkbox" id="consigneRealisee"> Consigne rÃ©alisÃ©e</label>
      <button type="button" onclick="saveConsigne()">Enregistrer</button>
    </form>

    <h3>Historique Consignes</h3>
    <ul id="listeConsignes"></ul>
  </section>

  <!-- SECTION PERSONNEL -->
  <section id="personnel" class="page">
    <h2>Personnel</h2>
    <form id="personnelForm">
      <label>Nom :</label>
      <input id="personnelNom" placeholder="Nom...">
      <label>RÃ´le :</label>
      <input id="personnelRole" placeholder="Poste ou fonction...">
      <button type="button" onclick="savePersonnel()">Enregistrer</button>
    </form>

    <h3>Historique Personnel</h3>
    <ul id="listePersonnel"></ul>
  </section>

  <!-- Calculatrice flottante -->
  <div id="calcIcon" onclick="toggleCalculator()">ðŸ§®</div>
  <div id="calculator" class="hidden">
    <input type="text" id="calcDisplay" readonly />
    <div class="calcButtons">
      <button onclick="pressCalc('7')">7</button>
      <button onclick="pressCalc('8')">8</button>
      <button onclick="pressCalc('9')">9</button>
      <button onclick="pressCalc('/')">Ã·</button>
      <button onclick="pressCalc('4')">4</button>
      <button onclick="pressCalc('5')">5</button>
      <button onclick="pressCalc('6')">6</button>
      <button onclick="pressCalc('*')">Ã—</button>
      <button onclick="pressCalc('1')">1</button>
      <button onclick="pressCalc('2')">2</button>
      <button onclick="pressCalc('3')">3</button>
      <button onclick="pressCalc('-')">âˆ’</button>
      <button onclick="pressCalc('0')">0</button>
      <button onclick="pressCalc('.')">.</button>
      <button onclick="calcClear()">C</button>
      <button onclick="pressCalc('+')">+</button>
      <button class="equal" onclick="calcEqual()">=</button>
    </div>
  </div>

  <footer>
    <p>SynthÃ¨se Atelier PPNC Â© 2025</p>
  </footer>

  <script src="app.js"></script>
</body>
</html>
