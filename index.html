<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Atelier PPNC</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>

<body>
  <header>
    <h1>Atelier PPNC</h1>
    <div id="dateTimeDisplay"></div>
  </header>

  <nav class="top-nav">
    <button onclick="showPage('atelier')">Atelier</button>
    <button onclick="showPage('arrets')">Arrêts</button>
    <button onclick="showPage('organisation')">Organisation</button>
    <button onclick="showPage('personnel')">Personnel</button>
  </nav>

  <main>
    <!-- Page Atelier -->
    <section id="atelier" class="page active">
      <h2>Vue d'ensemble Atelier</h2>
      <canvas id="atelierChart"></canvas>
      <div id="historiqueAtelier"></div>
      <button onclick="exportAllToExcel()">📊 Export global Excel</button>

      <div class="ligne-buttons">
        <h3>Lignes de Production</h3>
        <div id="ligneContainer"></div>
      </div>
    </section>

    <!-- Pages Production (lignes) -->
    <section id="production" class="page">
      <h2 id="ligneTitle">Ligne</h2>
      <form id="productionForm">
        <label>Heure Début :</label>
        <input type="time" id="heureDebut" required>
        <label>Heure Fin :</label>
        <input type="time" id="heureFin" required>
        <label>Quantité Produite :</label>
        <input type="number" id="quantiteProduite" placeholder="Colis..." required>
        <label>Quantité Restante :</label>
        <input type="number" id="quantiteRestante" placeholder="Colis restants..." />
        <label>Cadence Manuelle :</label>
        <input type="number" id="cadenceManuelle" placeholder="Saisir cadence..." />
        <p id="resultatsCalculs"></p>
        <button type="submit">💾 Enregistrer</button>
      </form>

      <div id="historiqueProduction"></div>
      <button onclick="remiseZeroLigne()">♻️ Remise à zéro</button>
      <button onclick="showPage('atelier')">⬅️ Retour Atelier</button>
    </section>

    <!-- Page Arrêts -->
    <section id="arrets" class="page">
      <h2>Arrêts de ligne</h2>
      <form id="arretForm">
        <label>Ligne :</label>
        <select id="ligneArret">
          <option value="">Choisir...</option>
          <option>Râpé</option>
          <option>T2</option>
          <option>RT</option>
          <option>OMORI T1</option>
          <option>Sticks</option>
          <option>Emballage</option>
          <option>Dés</option>
          <option>Filets</option>
          <option>Prédécoupés</option>
        </select>
        <label>Type :</label>
        <select id="typeArret">
          <option>Découpe</option>
          <option>Packing</option>
          <option>MEC</option>
        </select>
        <label>Durée (minutes) :</label>
        <input type="number" id="dureeArret" required>
        <label>Commentaire :</label>
        <input type="text" id="commentaireArret" />
        <button type="submit">💾 Enregistrer</button>
      </form>
      <div id="historiqueArrets"></div>
      <button onclick="showPage('atelier')">⬅️ Retour Atelier</button>
    </section>

    <!-- Page Organisation -->
    <section id="organisation" class="page">
      <h2>Organisation & Consignes</h2>
      <form id="consigneForm">
        <label>Consigne :</label>
        <input type="text" id="texteConsigne" required />
        <button type="submit">💾 Ajouter</button>
      </form>
      <div id="historiqueConsignes"></div>
      <button onclick="showPage('atelier')">⬅️ Retour Atelier</button>
    </section>

    <!-- Page Personnel -->
    <section id="personnel" class="page">
      <h2>Personnel</h2>
      <form id="personnelForm">
        <label>Nom :</label>
        <input type="text" id="nomPersonnel" required />
        <label>Motif :</label>
        <input type="text" id="motifPersonnel" required />
        <label>Commentaire :</label>
        <input type="text" id="commentairePersonnel" />
        <button type="submit">💾 Enregistrer</button>
      </form>
      <div id="historiquePersonnel"></div>
      <button onclick="showPage('atelier')">⬅️ Retour Atelier</button>
    </section>
  </main>

  <div id="calculatrice" class="floating">
    <button id="calcToggle">🧮</button>
    <div id="calcPanel" class="hidden">
      <input id="calcDisplay" readonly />
      <div id="calcButtons"></div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
